<!-- <template>
    <form class="form" @submit.prevent="submitForm">
      <h2 class="title">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
  
      <BaseInput 
        v-model="name"
        label="–ò–º—è"
        placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"
        :error="errorName"
        @blur="touchedName = true"
      />
      <BaseInput 
        v-model="phone"
        label="–¢–µ–ª–µ—Ñ–æ–Ω"
        placeholder="+7 (999) 999-99-99"
        :error="errorPhone"
        @blur="touchedPhone = true"
      />
      <BaseInput 
        v-model="email"
        label="E-mail"
        placeholder="example@mail.com"
        :error="errorEmail"
        @blur="touchedEmail = true"
      />
      <BaseInput 
        v-model="address"
        label="–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏"
        placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞"
        textarea
        :error="errorAddress"
        @blur="touchedAddress = true"
      />
  
      <BaseCheckbox 
        v-model="agree"
        :error="errorAgree"
        @change="touchedAgree = true"
      >
        –Ø –¥–∞—é —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –º–æ–∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
      </BaseCheckbox>
  
      <button class="submit">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
    </form>
  </template>
  
  <script setup>
  import { ref, computed } from "vue";
  import BaseInput from "../BaseInput/BaseInput.vue";
  import BaseCheckbox from "../BaseCheckbox/BaseCheckbox.vue";

  const emit = defineEmits(["submit"]);

  const props = defineProps({
    total: Number
  });

  const name = ref("");
  const phone = ref("");
  const email = ref("");
  const address = ref("");
  const agree = ref(false);

  const touchedName = ref(false);
  const touchedPhone = ref(false);
  const touchedEmail = ref(false);
  const touchedAddress = ref(false);
  const touchedAgree = ref(false);
  
  // –†–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –æ—à–∏–±–∫–∏ - –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π –∏ touched —Å–æ—Å—Ç–æ—è–Ω–∏–π
  // Computed —Å–≤–æ–π—Å—Ç–≤–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
  const errorName = computed(() => {
    if (!touchedName.value) {
      return "";
    }
    const val = name.value?.trim() || "";
    return val === "" ? "–í–≤–µ–¥–∏—Ç–µ –∏–º—è" : "";
  });
  
  const errorPhone = computed(() => {
    if (!touchedPhone.value) {
      return "";
    }
    const val = phone.value?.trim() || "";
    return val === "" ? "–í–≤–µ–¥–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω" : "";
  });
  
  const errorEmail = computed(() => {
    if (!touchedEmail.value) {
      return "";
    }
    const val = email.value?.trim() || "";
    if (val === "") {
      return "–í–≤–µ–¥–∏—Ç–µ e-mail";
    }
    if (!val.includes("@") || !val.includes(".")) {
      return "–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π e-mail";
    }
    return "";
  });
  
  const errorAddress = computed(() => {
    if (!touchedAddress.value) {
      return "";
    }
    const val = address.value?.trim() || "";
    return val === "" ? "–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å" : "";
  });
  
  const errorAgree = computed(() => {
    if (!touchedAgree.value) {
      return "";
    }
    return !agree.value ? "–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–≥–ª–∞—Å–∏–µ" : "";
  });
  
  function validate() {
    // –ü–æ–º–µ—á–∞–µ–º –≤—Å–µ –ø–æ–ª—è –∫–∞–∫ touched
    touchedName.value = true;
    touchedPhone.value = true;
    touchedEmail.value = true;
    touchedAddress.value = true;
    touchedAgree.value = true;
  
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—à–∏–±–∫–∏ –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –≤—Å–µ –ø–æ–ª—è –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ touched
    return !errorName.value && !errorPhone.value && !errorEmail.value && 
           !errorAddress.value && !errorAgree.value;
  }
  
  function submitForm() {
    if (!validate()) return;
  
    emit("submit", {
      name: name.value,
      phone: phone.value,
      email: email.value,
      address: address.value,
      total: props.total
    });
  }
  </script>
  
  <style scoped>
  .title {
    font-family: "Playfair Display";
    font-size: 22px;
    margin: 20px 0 12px;
  }
  
  .submit {
    width: 100%;
    background: #e7b39b;
    border: none;
    padding: 16px;
    margin-top: 20px;
    border-radius: 12px;
    color: white;
    font-size: 16px;
    font-weight: 600;
  }
  </style>
   -->

   <template>
    <form class="form" @submit.prevent="submit">
      <h2 class="title">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
  
      <BaseInput
        label="–ò–º—è"
        :model-value="form.fields.name"
        :error="form.errors.name"
        placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"
        @update:model-value="v => update('name', v)"
        @blur="form.touch('name')"
      />
  
      <BaseInput
        label="–¢–µ–ª–µ—Ñ–æ–Ω"
        :model-value="form.fields.phone"
        :error="form.errors.phone"
        placeholder="+7 (999) 999-99-99"
        @update:model-value="v => update('phone', v)"
        @blur="form.touch('phone')"
      />
  
      <BaseInput
        label="E-mail"
        :model-value="form.fields.email"
        :error="form.errors.email"
        placeholder="example@mail.com"
        @update:model-value="v => update('email', v)"
        @blur="form.touch('email')"
      />
  
      <BaseInput
        textarea
        label="–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏"
        :model-value="form.fields.address"
        :error="form.errors.address"
        placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞"
        @update:model-value="v => update('address', v)"
        @blur="form.touch('address')"
      />
  
      <BaseCheckbox
        :model-value="form.fields.agree"
        :error="form.errors.agree"
        @update:model-value="v => update('agree', v)"
        @change="form.touch('agree')"
      >
        –Ø –¥–∞—é —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
      </BaseCheckbox>
  
      <button class="submit">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
    </form>
  </template>
  
  <script setup>
  import { useOrderFormStore } from "../../stores/OrderFormStore"
  import BaseInput from "../BaseInput/BaseInput.vue";
  import BaseCheckbox from "../BaseCheckbox/BaseCheckbox.vue";
  
  const form = useOrderFormStore()
  
  const update = (key, value) => {
    form.setField(key, value)
    form.touch(key) // üîë –æ—à–∏–±–∫–∞ –∏—Å—á–µ–∑–∞–µ—Ç –ø—Ä–∏ –≤–≤–æ–¥–µ
  }
  
  const submit = () => {
    form.touchAll()
    if (!form.isValid) return
  
    console.log("SUBMIT DATA:", form.fields)
  }
  </script>  

    <style scoped>
      .title {
        font-family: "Playfair Display";
        font-size: 22px;
        margin: 20px 0 12px;
      }
      
      .submit {
        width: 100%;
        background: #e7b39b;
        border: none;
        padding: 16px;
        margin-top: 20px;
        border-radius: 12px;
        color: white;
        font-size: 16px;
        font-weight: 600;
      }
      </style>